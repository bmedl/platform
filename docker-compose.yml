version: "2"
services:
  backend:
    build:
      context: .
      dockerfile: deploy/Dockerfile.backend
    restart: unless-stopped
    networks: 
      - docker_default

  collect:
    build:
      context: .
      dockerfile: deploy/Dockerfile.collect
    restart: unless-stopped
    environment: 
      - DB_USER
      - DB_PASSWORD
      - DB_ADDRESS
      - V20_ACCOUNT_ID
      - V20_APPLICATION_NAME
      - V20_TOKEN
      - V20_INSTRUMENTS
    networks:
      - docker_default
  
  train:
    build:
      context: .
      dockerfile: deploy/Dockerfile.neuralnet
    restart: unless-stopped
    environment: 
      - TASKS=train
    networks:
      - docker_default

  frontend:
    build:
      context: .
      dockerfile: deploy/Dockerfile.frontend
    restart: unless-stopped
    networks:
      - docker_default

networks:
  docker_default:
    external: true
